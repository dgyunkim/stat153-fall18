# import data
dat <- read.csv("arXiv.csv", stringsAsFactors = FALSE)
# data cleaning
dat
dat
str(data)
str(dat)
# data cleaning
my_ts <- ts(dat[, 2], start = c(1991, 7), end = c(2018, 9), frequency = 12)
my_tse
my_ts
# series plot
plot(my_ts)
# transformation
trans_ts <- c(0, my_ts[-1] / sqrt(my_ts[-1]))
trans_ts
plot(trnas_ts)
plot(trans_ts)
?ts
?subset()
subset(my_ts, subset = [-1])
subset(my_ts, subset = [1:length(my_ts)])
subset(my_ts, subset = 1:length(my_ts)])
subset(my_ts, subset = 1:length(my_ts))
subset(my_ts, drop = [1])
subset(my_ts, drop = 1)
subset(my_ts, start = 1)
my_ts
subset(my_ts, start = c(1991, 8))
?window()
window(my_ts, start = c(1991, 8))
# transformation
trans_ts <- window(my_ts, start = c(1991, 8)) / sqrt(window(my_ts), start = c(1991, 8))
# transformation
my_ts[-1] / sqrt(my_ts[-1])
# transformation
trans_ts <- ts(c(0, my_ts[-1] / sqrt(my_ts[-1])), start = c(1991, 7),
end = c(2018, 9), frequency = 12)
plot(trans_ts)
# series plot
plot(my_ts, main = "Time Series Plot", ylab = "Value")
# series plot
plot(my_ts, main = "Time Series Plot", ylab = "Value", las = 1)
# transformed series plot
plot(trans_ts)
# transformed series plot
plot(trans_ts, main = "Transformed Time Series Plot", ylab = "Value", las = 1)
end = c(2018, 9), frequency = 12)
# transformation
trans_ts <- ts(c(0, my_ts[-1] / sqrt(mean(my_ts[-1]))), start = c(1991, 7),
end = c(2018, 9), frequency = 12)
# transformed series plot
plot(trans_ts, main = "Transformed Time Series Plot", ylab = "Value", las = 1)
# transformation
trans_ts <- ts(c(0, my_ts[-1] / sqrt(my_ts[-1])), start = c(1991, 7),
end = c(2018, 9), frequency = 12)
# transformed series plot
plot(trans_ts, main = "Transformed Time Series Plot", ylab = "Value", las = 1)
diff_my_ts <- diff(my_ts)
diff_my_ts
plot(diff_my_ts)
diff_trans_ts <- diff(trans_ts)
par(mfrow=c(1,2))
par(mfrow=c(1,2))
plot(diff_my_ts)
plot(diff_trans_ts)
par(mfrow=c(2,1))
plot(diff_my_ts)
plot(diff_trans_ts)
plot(diff_my_ts, main = "Differencing Original Series", ylab = "Value")
plot(diff_trans_ts, main = "Differencing Transformed Series", ylab = "Vlaue")
plot(diff_my_ts, main = "Differencing Original Series", ylab = "Value")
acf(diff_trans_ts)
acf(diff_my_ts)
acf(diff_trans_ts)
# differencing and plot
diff_my_ts <- diff(my_ts)
diff_trans_ts <- diff(trans_ts)
par(mfrow=c(2,1))
plot(diff_my_ts, main = "Differencing Original Series", ylab = "Value")
plot(diff_trans_ts, main = "Differencing Transformed Series", ylab = "Vlaue")
acf(diff_my_ts)
acf(diff_trans_ts)
acf(diff_my_ts, main = "Correlogram of Differenced Original Series")
acf(diff_trans_ts, main = "Correlogram of Differenced Transformed Series")
acf(diff_my_ts, main = "Correlogram of Differenced Original Series")
acf(diff_trans_ts, main = "Correlogram of Differenced Transformed Series")
acf(diff_trans_ts, main = "Correlogram of Differenced Transformed Series")
diff_trans_ts
diff_trans_ts[-length(diff_trans_ts)]
last <- length(trans_ts)
diff_last <- length(diff_trans_ts)
trans_last
trans_ts[last]
trans_ts
trans_ts[last - 1]
trans_ts[last - 1] + mean(diff_trans_ts[-diff_last])
mean(diff_trans_ts[-diff_last])
(trans_ts[last - 1] + mean(diff_trans_ts[-diff_last]))^2
my_ts
library(TSA)
retail
library(TSA)
retail
data("retail")
retail
sqrt(retail)
yt <- sqrt(retail)
plot(yt)
plot(yt, main = "Transformed Time Series")
plot(yt, main = "Transformed Time Series", las = 1)
t <- time(retail)
yt
t <- time(yt)
lm_sinusoid <- lm(yt ~ t + I(cos(2*pi*t/12)) + I(sin(2*pi*t/12)))
lm_sinusoid
abline(lm_sinusoid)
plot(yt)
abline(lm_sinusoid)
plot(yt)
lines(lm_sinusoid$fitted.values)
plot(yt)
lines(lm_sinusoid$fitted.values, col = "red")
plot(x = t, y = lm_sinusoid$fitted.values)
lm_sinusoid <- lm(yt ~ t + I(cos(2*pi*t/12)) + I(sin(2*pi*t/12)) +
I(cos(2*pi*t/6)) + I(sin(2*pi*t/6)))
plot(x = t, y = lm_sinusoid$fitted.values)
plot(yt)
lines(lm_sinusoid$fitted.values, col = "red")
plot*yt
plot(yt)
lines(lm_sinusoid$fitted.values, col = "red")
abline(lm_sinusoid)
fv <- lm_sinusoid$fitted.values
fv
plot(yt)
plot(yt)
lines(fv, col = "red")
plot(fv)
yt
fv <- ts(lm_sinusoid$fitted.values, start = c(1986,1), end = c(2007, 3),
frequency = 12)
plot(yt)
plot(yt)
lines(fv, col = "red")
lm_sinusoid <- lm(yt ~ t + I(cos(2*pi*t/12)) + I(sin(2*pi*t/12)) +
I(cos(2*pi*t/6)) + I(sin(2*pi*t/6)) +
I(cos(2*pi*t/4)) + I(sin(2*pi*t/4)) +
I(cos(2*pi*t/3)) + I(sin(2*pi*t/3)) +
I(cos(2*pi*t/2)))
fv <- ts(lm_sinusoid$fitted.values, start = c(1986,1), end = c(2007, 3),
frequency = 12)
plot(yt)
lines(fv, col = "red")
lm_sinusoid
lm_sinusoid <- lm(yt ~ t + cos(2*pi*t/12) + sin(2*pi*t/12) +
cos(2*pi*t/6) + I(sin(2*pi*t/6)) +
I(cos(2*pi*t/4)) + I(sin(2*pi*t/4)) +
I(cos(2*pi*t/3)) + I(sin(2*pi*t/3)) +
I(cos(2*pi*t/2)))
lm_sinusoid
lines(t, fv, col = "red")
plot(yt)
lines(t, fv, col = "red")
plot(t, yt)
lines(t, fv, col = "red")
t <- time(yt)
lm_sinusoid <- lm(yt ~ t + cos(2*pi*t/12) + sin(2*pi*t/12) +
cos(2*pi*t/6) + I(sin(2*pi*t/6)) +
I(cos(2*pi*t/4)) + I(sin(2*pi*t/4)) +
I(cos(2*pi*t/3)) + I(sin(2*pi*t/3)) +
I(cos(2*pi*t/2)))
fv <- ts(lm_sinusoid$fitted.values, start = c(1986,1), end = c(2007, 3),
frequency = 12)
plot(t, yt)
plot(t, yt)
lines(t, fv, col = "red")
plot(yt)
lines(fv, col = "red")
periodic_terms <- matrix(nrow=length(sqrt_retail), ncol=12)
for (i in 1:6) {
periodic_terms[, 2*i - 1] <- cos(2 * pi * i * t / 12)
periodic_terms[, 2*i] <- sin(2 * pi * i * t / 12)
}
periodic_terms <- matrix(nrow=length(yt), ncol=12)
for (i in 1:6) {
periodic_terms[, 2*i - 1] <- cos(2 * pi * i * t / 12)
periodic_terms[, 2*i] <- sin(2 * pi * i * t / 12)
}
periodic_terms
colnames(periodic_terms) <- paste0(c('cos', 'sin'), rep(1:6, each=2))
periodic_terms
periodic_terms[, -ncol(periodic_terms)]
-ncol(periodic_terms)
sinusoid <- matrix(0)
sinusoid
sinusoid[2,1] <- 1
sinusoid <- matrix(0, nrow = nrow(yt), ncol = 12)
for (i in 1:6){
sinusoid[, 2*i - 1] <- cos(2*pi*i*t/12)
sinusoid[, 2*i] <- sin(2*pi*i*t/12)
}
sinusoid
colnames(sinusoid) <- paste0(c("cos", "sin"), 1:6)
colnames(sinusoid) <- c(paste0("cos" 1:6), paste0("sin", 1:6))
colnames(sinusoid) <- c(paste0("cos", 1:6), paste0("sin", 1:6))
sinusoid
colnames(sinusoid) <- paste0(rep(c("cos", "sin"), 6), rep(1:6, each = 2))
sinusoid
lm_sinusoid <- lm(yt ~ t + sinusoid[, -12])
lm_sinusoid
yt
fv <- ts(lm_sinusoid$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt)
lines(fv, col = "red")
t <- time(yt)
# import data
dat <- read.csv("arXiv.csv", stringsAsFactors = FALSE)
# data cleaning
my_ts <- ts(dat[, 2], start = c(1991, 7), end = c(2018, 9), frequency = 12)
# series plot
plot(my_ts, main = "Time Series Plot", ylab = "Value", las = 1)
# transformation
trans_ts <- ts(c(0, my_ts[-1] / sqrt(my_ts[-1])), start = c(1991, 7),
end = c(2018, 9), frequency = 12)
# transformed series plot
plot(trans_ts, main = "Transformed Time Series Plot", ylab = "Value", las = 1)
# differencing and plot
diff_my_ts <- diff(my_ts)
diff_trans_ts <- diff(trans_ts)
par(mfrow=c(2,1))
plot(diff_my_ts, main = "Differencing Original Series", ylab = "Value")
plot(diff_trans_ts, main = "Differencing Transformed Series", ylab = "Vlaue")
acf(diff_my_ts, main = "Correlogram of Differenced Original Series")
acf(diff_trans_ts, main = "Correlogram of Differenced Transformed Series")
last <- length(trans_ts)
diff_last <- length(diff_trans_ts)
(trans_ts[last - 1] + mean(diff_trans_ts[-diff_last]))^2
library(TSA)
data("retail")
yt <- sqrt(retail)
plot(yt, main = "Transformed Time Series", las = 1)
t <- time(yt)
sinusoid <- matrix(0, nrow = nrow(yt), ncol = 12)
for (i in 1:6){
sinusoid[, 2*i - 1] <- cos(2*pi*i*t/12)
sinusoid[, 2*i] <- sin(2*pi*i*t/12)
}
colnames(sinusoid) <- paste0(rep(c("cos", "sin"), 6), rep(1:6, each = 2))
lm_sinusoid <- lm(yt ~ t + sinusoid[, -12])
fv <- ts(lm_sinusoid$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt)
lines(fv, col = "red")
sqrt_retail <- sqrt(retail)
actual_t <- as.numeric(time(sqrt_retail))
t <- 1:length(sqrt_retail)
plot(sqrt_retail)
periodic_terms <- matrix(nrow=length(sqrt_retail), ncol=12)
for (i in 1:6) {
periodic_terms[, 2*i - 1] <- cos(2 * pi * i * t / 12)
periodic_terms[, 2*i] <- sin(2 * pi * i * t / 12)
}
colnames(periodic_terms) <- paste0(c('cos', 'sin'), rep(1:6, each=2))
param_seasonal_fit <- lm(sqrt_retail ~ t + periodic_terms[, -ncol(periodic_terms)])
plot(t, sqrt_retail, type='l')
lines(t, param_seasonal_fit$fitted.values, col='red')
param_seasonal_fit
t
t <- 1:nrow(yt)
sinusoid <- matrix(0, nrow = nrow(yt), ncol = 12)
for (i in 1:6){
sinusoid[, 2*i - 1] <- cos(2*pi*i*t/12)
sinusoid[, 2*i] <- sin(2*pi*i*t/12)
}
colnames(sinusoid) <- paste0(rep(c("cos", "sin"), 6), rep(1:6, each = 2))
lm_sinusoid <- lm(yt ~ t + sinusoid[, -12])
fv <- ts(lm_sinusoid$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt)
lines(fv, col = "red")
library(forecast)
dummies <- seasonaldummy(yt)
dummies
lm_dummy <- lm(yt ~ t + dummies)
yt
fv <- ts(lm_dummy$fitted.values, start = c(1986, 1), end = c(2007, 3))
fv
fv <- ts(lm_dummy$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt)
lines(fv, col = "blue")
plot(yt, main = "Seasonal Dummy", las = 1)
lines(fv, col = "blue")
t <- 1:nrow(yt)
sinusoid <- matrix(0, nrow = nrow(yt), ncol = 12)
for (i in 1:6){
sinusoid[, 2*i - 1] <- cos(2*pi*i*t/12)
sinusoid[, 2*i] <- sin(2*pi*i*t/12)
}
colnames(sinusoid) <- paste0(rep(c("cos", "sin"), 6), rep(1:6, each = 2))
lm_sinusoid <- lm(yt ~ t + sinusoid[, -12])
fv <- ts(lm_sinusoid$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt, main = "Sinusoid", las = 1)
lines(fv, col = "red")
library(forecast)
dummies <- seasonaldummy(yt)
lm_dummy <- lm(yt ~ t + dummies)
fv <- ts(lm_dummy$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt, main = "Seasonal Dummy", las = 1)
lines(fv, col = "blue")
t <- 1:nrow(yt)
sinusoid <- matrix(0, nrow = nrow(yt), ncol = 12)
for (i in 1:6){
sinusoid[, 2*i - 1] <- cos(2*pi*i*t/12)
sinusoid[, 2*i] <- sin(2*pi*i*t/12)
}
colnames(sinusoid) <- paste0(rep(c("cos", "sin"), 6), rep(1:6, each = 2))
lm_sinusoid <- lm(yt ~ t + sinusoid[, -12])
fv_sinusoid <- ts(lm_sinusoid$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt, main = "Sinusoid", las = 1)
lines(fv_sinusoid, col = "red")
library(forecast)
dummies <- seasonaldummy(yt)
lm_dummy <- lm(yt ~ t + dummies)
fv_dummy <- ts(lm_dummy$fitted.values, start = c(1986, 1), end = c(2007, 3),
frequency = 12)
plot(yt, main = "Seasonal Dummy", las = 1)
lines(fv_dummy, col = "blue")
fv_dummy - fv_sinusoid
are_they_equal <- function(a, b, tolerance=10^(-10)){
if (a - b < tolerance) {
TRUE
} else {
FALSE
}
}
are_they_equal(fv_dummy, fv_sinusoid)
sum(fv_dummy - fv_sinusoid)
if (sum(abs(difference)) < tolerance) {
TRUE
} else {
FALSE
}
are_they_equal <- function(a, b, tolerance=10^(-10)){
difference <- a - b
if (sum(abs(difference)) < tolerance) {
TRUE
} else {
FALSE
}
}
are_they_equal(fv_dummy, fv_sinusoid)
diff_yt <- diff(yt)
seas_yt <- diff(yt, lag = 12)
diff_seas_yt <- diff(diff(yt, lag = 12))
par(mfrow=c(3,1))
plot(diff_yt)
plot(seas_yt)
plot(diff_seas_yt)
diff_yt <- diff(yt)
seas_yt <- diff(yt, lag = 12)
diff_seas_yt <- diff(diff(yt, lag = 12))
par(mfrow=c(3,1))
plot(diff_yt, main = "First Differenced Series", las = 1)
plot(seas_yt, main = "Seasonal Differenced Series", las = 1)
plot(diff_seas_yt, main = "First Difference of Seasonal Differenced Series",
las = 1)
80-16
64/16
0.01 + 0.04
6.4 / 16
sqrt(0.4)
8-0.16
7.84 / 16
sqrt(0.49)
