?rnorn
?rnorm
set.seed(510)
Z <- rnorm(n = 100)
X <- c(0, 0)
X
X <- rep(0, 100)
X
for (i in 3:length(X)){
X[i] <- 0.7 * X[i-1] - 0.3 * X[i-2] + Z[i] + 4 * Z[i-2]
}
plot(X)
plot(X, type = "l")
acf(X)
set.seed(510)
C <- rcauchy(100)
Y <- rep(0, 100)
set.seed(510)
C <- rcauchy(n = 100)
Y <- rep(0, 100)
for (i in 3:length(Y)){
Y[i] <- 0.7 * Y[i-1] - 0.3 * Y[i-2] + C[i] + 4 * C[i-2]
}
plot(Y, type = "l")
acf(Y)
plot(Y, type = "l")
plot(Y, type = "l", las = 1, main = "ARMA(2,2) with Cauchy Noise")
plot(X, type = "l", las = 1, main = "ARMA(2,2) with Gaussian Noise")
par(mfrow=c(1,2))
plot(X, type = "l", las = 1, main = "ARMA(2,2) with Gaussian Noise")
acf(X)
par(mfrow=c(2,1))
plot(X, type = "l", las = 1, main = "ARMA(2,2) with Gaussian Noise")
acf(X)
acf(X, las = 1, main = "Correlogram")
acf(Y, las = 1, main = "Correlogram")
par(mfrow=c(2,1))
ARMAacf(X)
X_acf <- ARMAacf(X)
X_acf[2:21]
1 + sum(X_acf[2:21]^2)
X_acf <- ARMAacf(X)
X_acf[2:21]
?ARMAacf()
X_acf <- ARMAacf(ar = c(0.7, -0.3), ma = c(0, 4))
X_acf
X_acf <- ARMAacf(ar = c(0.7, -0.3), ma = c(0, 4), lag.max = 20)
X_acf
X_acf[2:21]
1 + sum(X_acf[2:21]^2)
# 95% confidence bands
1.96 * sqrt((1 + sum(X_acf[2:21]^2)) / 100)
X_acf[2:]
X_acf[2:21]
# 95% confidence bands
W <- 1 + sum(X_acf[2:21]^2)
# 95% confidence bands
W <- 1 + sum(X_acf[2:21]^2)
upper <- X_acf[2:21] + 1.96 * sqrt(W / 100)
lower <- X_acf[2:21] - 1.96 * sqrt(W / 100)
upper
lower
plot(X_acf)
lines(upper)
plot(X_acf)
lines(upper)
plot(X_acf)
lines(upper, lty = 2, col = "blue")
plot(X_acf, type = "h")
plot(X_acf, type = "h")
abline(h = 0, lwd = 2)
lines(upper, lty = 2, col = "blue")
lines(upper, lty = 2, col = "red")
plot(X_acf, type = "h")
abline(h = 0)
lines(upper, lty = 2, col = "red")
plot(X_acf, type = "h")
abline(h = 0)
lines(upper, lty = 2, col = "red")
lines(lower, lty = 2, col = "red")
plot(X_acf, type = "h", ylim = c(-1.0, 1.0))
plot(X_acf, type = "h", ylim = c(-1.0, 1.0))
abline(h = 0)
lines(upper, lty = 2, col = "red")
lines(lower, lty = 2, col = "red")
acf(X)
acf(X, ylim = c(-1.0, 1.0)
acf(X, ylim = c(-1.0, 1.0))
acf(X, ylim = c(-1.0, 1.0))
lower <- X_acf[2:21] - 1.96 * sqrt(W / 100)
acf(X, ylim = c(-1.0, 1.0))
points(X_acf, type = "h")
?points
acf(X, ylim = c(-1.0, 1.0))
points(X_acf, type = "o")
points(X_acf, type = "o", col = "green")
acf(X, ylim = c(-1.0, 1.0))
points(X_acf, type = "o", col = "green")
acf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
acf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
points(X_acf, type = "o", col = "green")
acf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
points(X_acf, type = "o", col = "green")
lines(upper, lty = 2, col = "red")
lines(lower, lty = 2, col = "red")
cf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
acf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
points(X_acf, type = "o", col = "green")
lines(upper, lty = 2, col = "red")
lines(lower, lty = 2, col = "red")
legend("topright",
legend = c("Sample ACF", "Theoretical ACF",
"White Noise Var", "Bartlett's Formula"),
lty = (1, 1, 2, 2), col = c("black", "green", "blue", "red"))
acf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
points(X_acf, type = "o", col = "green")
lines(upper, lty = 2, col = "red")
lines(lower, lty = 2, col = "red")
legend("topright",
legend = c("Sample ACF", "Theoretical ACF",
"White Noise Var", "Bartlett's Formula"),
lty = c(1, 1, 2, 2), col = c("black", "green", "blue", "red"))
acf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
points(X_acf[2:21], type = "o", col = "green")
W <- 1 + sum(X_acf[2:21]^2)
upper <- X_acf[2:21] + 1.96 * sqrt(W / 100)
lower <- X_acf[2:21] - 1.96 * sqrt(W / 100)
acf(X, ylim = c(-1.0, 1.0), main = "Correlogram")
points(X_acf[2:21], type = "o", col = "green")
lines(upper, lty = 2, col = "red")
lines(lower, lty = 2, col = "red")
legend("topright",
legend = c("Sample ACF", "Theoretical ACF",
"White Noise", "Bartlett's Formula"),
lty = c(1, 1, 2, 2), col = c("black", "green", "blue", "red"))
ARMAtoMA()
?ARMAtoMA()
psi <- ARMAtoMA(ar = c(0.7, -0.3), ma = c(0, 4), lag.max = 20)
psi
set.seed(510)
Z_past <- rnorm(n = 20)
names(Z_past)
-19:0
names(Z_past) <- -19:0
Z_past
names(Z_past) <- 0:-19
Z_past
Z
X_new <- rep(0, 100)
psi
Z_ppa
Z_pas
Z_past
X_new[1] <- Z[1] + psi*Z_past
length(psi)
length(Z_past)
psi * Z_past
X_new[1] <- Z[1] + sum(psi * Z_past)
X_new[1]
Z_pa
Z_past
Z_past <- c(Z[1], Z_past[-20])
Z_past
X_new[2] <- Z[2] + sum(psi * Z_past)
for (i in 3:length(X_new)){
X_new[i] <- 0.7 * X_new[i-1] - 0.3 * X_new[i-2] + Z[i] + 4 * Z[i-2]
}
X_new
X
plot(X_new, type = "l", las = 1, main = "ARMA(2,2) with Gaussian Noise")
acf(X_new, las = 1, main = "Correlogram")
psi_new <- c(1, psi[1:2])
theta <- c(1, 0, 4)
sigma2 <- 1
first <- sum(psi_new * theta) * sigma2
second <- sum(psi_new[1:2] * theta[-1]) * sigma2
third <- psi_new[1] * theta[3] * sigma2
# solve linear system with matrix
mat <- matrix(c(1, -0.7, 0.3, 17.76, -0.7, 1.3, 0, 2.8, 0.3, -0.7, 1, 4),
nrow = 3, byrow = TRUE)
mat
for (i in 2:3) {
for (j in 1:(i-1)) {
mat[i, ] <- mat[i, ] - mat[i, j] * mat[j, ]
}
mat[i, ] <- mat[i, ] / mat[i, i]
}
for (i in 2:1) {
for (j in 3:(i+1)) {
mat[i, ] <- mat[i, ] - mat[i, j] * mat[j, ]
}
}
mat
gamma_X <- mat[, 4]
```{r}
for (t in 4:21) {
gamma_X[t] <- 0.7 * gamma_X[t-1] - 0.3 * gamma_X[t-2]
}
names(gamma_X) <- paste("Lag", 0:20)
gamma_X
rho_X <- gamma_X / gamma_X[1]
rho_X
error <- rho_X - acf_ARMA
error <- rho_X - X_acf
par(mfrow = c(1, 2))
plot(x = 0:20, y = rho_X, type = "h", xlab = "Lag", ylab = "ACF")
points(x = 0:20, acf_ARMA, type = "h", col = "red", lwd = 2, lty = 2)
plot(x = 0:20, y = rho_X, type = "h", xlab = "Lag", ylab = "ACF")
points(x = 0:20, X_acf, type = "h", col = "red", lwd = 2, lty = 2)
abline(h = 0)
plot(x = 0:20, y = error, xlab = "Lag", ylab = "Error",
main = "Error Plot")
plot(x = 0:20, y = rho_X, type = "h", xlab = "Lag", ylab = "ACF")
points(x = 0:20, X_acf, type = "o", col = "red", lwd = 2, lty = 2)
abline(h = 0)
plot(x = 0:20, y = rho_X, type = "h", xlab = "Lag", ylab = "ACF")
points(x = 0:20, X_acf, type = "o", col = "red", lwd = 2, lty = 2)
abline(h = 0)
plot(x = 0:20, y = error, xlab = "Lag", ylab = "Error",
plot(x = 0:20, y = error, xlab = "Lag", ylab = "Error",
main = "Error Plot")
plot(x = 0:20, y = error, xlab = "Lag", ylab = "Error",
abline(h = 0)
plot(x = 0:20, y = error, xlab = "Lag", ylab = "Error",
main = "Error Plot")
# are they equal?
equal(acf_ARMA, rho_X)
equal <- function(a, b, tol = 10^(-10)) {
if (sum(abs(a - b)) <= tol) {
TRUE
} else {
FALSE
}
}
# are they equal?
equal(acf_ARMA, rho_X)
# are they equal?
equal(acf_ARMA, rho_X)
# are they equal?
equal(X_acf, rho_X)
plot(x = 0:20, y = rho_X, type = "h", xlab = "Lag", ylab = "ACF")
plot(x = 0:20, y = rho_X, type = "h", xlab = "Lag", ylab = "ACF")
points(x = 0:20, X_acf, type = "o", col = "red", lwd = 2, lty = 2)
abline(h = 0)
