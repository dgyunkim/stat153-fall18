dat <- LakeHuron
plot(dat)
t <- time(dat)
lm_trend <- lm(dat ~ t)
plot(dat)
abline(lm_trend)
plot(dat, main = "Time Series Plot with Linear Trend", ylab = "Value", las = 1)
abline(lm_trend, col = "red")
plot(dat, main = "Time Series Plot with Linear Trend", ylab = "Value", las = 1)
abline(lm_trend, col = "red")
legend("topright", legend = "Linear Trend", col = "red", lty = 1)
# residuals
r <- lm_trend$residuals
?arima
arima(r, order = c(1, 0, 0))
my_arima <- arima(r, order = c(1, 0, 0))
my_arima
intercept = (1 - 0.7829) * 0.0797
my_arima$coef
my_arima$coef[1]
phi <- my_arima$coef[1]
intercept <- (1 - phi) * my_arima$coef[2]
length(r)
X0 <- r[98]
phi <- my_arima$coef[1]
intercept <- (1 - phi) * my_arima$coef[2]
phi <- my_arima$coef[1]
intercept <- (1 - phi) * my_arima$coef[2]
X0 <- r[98]
for (i in 1:30){
X0 <- intercept + phi * X0
}
X0
intercept <- (1 - phi) * my_arima$coef[[2]]
phi <- my_arima$coef[[1]]
ogu
phi
X0 <- r[98]
for (i in 1:30){
X0 <- intercept + phi * X0
}
X0
phi <- my_arima$coef[[1]]
intercept <- (1 - phi) * my_arima$coef[[2]]
X0 <- r[98]
for (i in 1:30){
X0 <- intercept + phi * X0
}
X0
X0 <- r[[98]]
phi <- my_arima$coef[[1]]
intercept <- (1 - phi) * my_arima$coef[[2]]
X0 <- r[[98]]
for (i in 1:30){
X0 <- intercept + phi * X0
}
X0
r_future <- rep(0, 30)
phi <- my_arima$coef[[1]]
intercept <- (1 - phi) * my_arima$coef[[2]]
r_future <- rep(0, 30)
r_future[1] <- intercept + phi * r[[98]]
r_future
for (i in 2:30){
r_future[i] <- intercept + phi * r_future[i-1]
}
r_future
?predict
predict.arima
?predict.arima
predict(my_arima, n.ahead = 30)
my_arima
r[98]
r_future[1] <- intercept + phi * r[[98]]
r_future
r_future
phi <- my_arima$coef[[1]]
intercept <- (1 - phi) * my_arima$coef[[2]]
r_future <- rep(0, 30)
r_future[1] <- intercept + phi * r[[98]]
for (i in 2:30){
r_future[i] <- intercept + phi * r_future[i-1]
}
r_future
predict(my_arima, n.ahead = 30)
predict(my_arima, n.ahead = 30)$pred
lm_trend
lm_trend
lm_trend$model
srt(lm_trend$model)
str(lm_trend$model)
trend_future <- predict(lm_trend, newdata = data.frame(t = 1973:1002))
trend_future
trend_future <- predict(lm_trend, newdata = data.frame(t = 1973:2002))
tredn_future
tredn
trend_future
LakeHuron[98]
r_future
tredn_future + r_future
trend_future + r_future
predictions <- trend_future + r_future
plot(dat)
points(x = 1973:2002, y = predictions)
plot(dat)
points(x = 1973:2002, y = predictions)
dat
plot(dat, xlim = c(1870, 2005))
lines(x = 1973:2002, y = predictions)
plot(dat, xlim = c(1875, 2002))
lines(x = 1973:2002, y = predictions)
plot(dat, xlim = c(1875, 2002))
lines(x = 1973:2002, y = predictions)
abline(v = 1973)
plot(dat, xlim = c(1875, 2002))
lines(x = 1972:2002, y = predictions)
plot(dat, xlim = c(1875, 2002))
lines(x = 1972:2001, y = predictions)
plot(dat, xlim = c(1875, 2002))
lines(x = 1972:2002, y = c(dat[98], predictions))
plot(dat, xlim = c(1875, 2002))
lines(x = 1972:2002, y = c(dat[98], predictions))
abline(v = 1973)
plot(dat, xlim = c(1875, 2002))
lines(x = 1972:2002, y = c(dat[98], predictions), col = "red")
abline(v = 1973)
plot(dat, xlim = c(1875, 2002))
lines(x = 1972:2002, y = c(dat[98], predictions))
abline(v = 1973, col = "red")
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
abline(v = 1973, col = "red")
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
abline(v = 1973, col = "red")
legend("topright", legend = "Prediction for 30 Years", lty = 2)
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
abline(v = 1973, col = "red")
legend("topright", legend = "Prediction for 30 Years", lty = 2, cex = 0.5)
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
abline(v = 1973, col = "red")
legend("topright", legend = c("Prediction for 30 Years", "1973"),
lty = 2:1, col = c("black", "red"), cex = 0.7)
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
abline(v = 1973, col = "red")
legend("topright", legend = c("Prediction for 30 Years", "1973"),
lty = 2:1, col = c("black", "red"), cex = 0.6)
var_r_future <- var(r_future)
var_r_future
se_r_future <- sqrt(var(r_future))
upper <- predictions + 1.96 * se_r_future
lower <- predictions - 1.96 * se_r_future
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(upper, col = "green")
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
my_arima$sigma2
var(r)
?arima
sigma2 <- my_arima$sigma2
sigma2
r
var(r_future)
sigma2
upper <- predictions + 1.96 * sqrt(sigma2 * (1 - phi^(2*(1:30)) / (1 - phi^2)))
upper
predictions
phi^(1:10)
phi^(2*(1:10))
phi^(2*(1:30))
1 - phi^(2*(1:30))
(1 - phi^(2*(1:30))) / (1 - phi^2)
sigma2*((1 - phi^(2*(1:30))) / (1 - phi^2))
upper <- predictions + 1.96 * sigma2*((1 - phi^(2*(1:30))) / (1 - phi^2))
upper <- predictions + 1.96 * sqrt(sigma2*((1 - phi^(2*(1:30))) / (1 - phi^2)))
lower
lower <- predictions - 1.96 * sqrt(sigma2 * ((1 - phi^(2*(1:30))) / (1 - phi^2)))
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
plot(dat, xlim = c(1875, 2002), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
abline(v = 1973, col = "red")
legend("topright", legend = c("Predictions of 30 Years", "1973"),
lty = 2:1, col = c("black", "red"), cex = 0.6)
plot(dat, xlim = c(1875, 2002), ylim = c(560, 590)
ylab = "Value", las = 1,
plot(dat, xlim = c(1875, 2002), ylim = c(560, 590),
ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
abline(v = 1973, col = "red")
plot(dat, xlim = c(1875, 2002), ylim = c(570, 590), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
plot(dat, xlim = c(1875, 2002), ylim = c(570, 590), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
plot(dat, xlim = c(1875, 2002), ylim = c(570, 580), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
plot(dat, xlim = c(1875, 2002), ylim = c(570, 585), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
plot(dat, xlim = c(1875, 2002), ylim = c(575, 585), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
plot(dat, xlim = c(1875, 2002), ylim = c(575, 585), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
abline(v = 1973, col = "red")
legend("topright", legend = c("Predictions of 30 Years", "1973"),
plot(dat, xlim = c(1875, 2002), ylim = c(575, 585), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
plot(dat, xlim = c(1875, 2002), ylim = c(575, 585), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
abline(v = 1973, col = "red")
legend("topright", legend = c("Predictions of 30 Years", "1973"),
lty = 2:1, col = c("black", "red"), cex = 0.6)
plot(dat, xlim = c(1875, 2002), ylim = c(573, 583), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
abline(v = 1973, col = "red")
legend("topright", legend = c("Predictions of 30 Years", "1973"),
lty = 2:1, col = c("black", "red"), cex = 0.6)
plot(dat, xlim = c(1875, 2002), ylim = c(573, 583), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
abline(v = 1973, col = "red")
legend("topright",
legend = c("Predictions of 30 Years", "Prediction Interval", "1973",),
lty = c(2, 1, 1), col = c("black", "green", "red"), cex = 0.6)
plot(dat, xlim = c(1875, 2002), ylim = c(573, 583), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
abline(v = 1973, col = "red")
legend("topright",
legend = c("Predictions of 30 Years", "Prediction Interval", "1973"),
lty = c(2, 1, 1), col = c("black", "green", "red"), cex = 0.6)
predict(my_arima, n.ahead = 30)$se
se_pf <- predict(my_arima, n.ahead = 30)$se
upper_pf <- predictions + 1.96 * se_pf
upper
upper_pf
lower_pf <- predictions - 1.96 * se_pf
se_pf <- predict(my_arima, n.ahead = 30)$se
upper_pf <- predictions + 1.96 * se_pf
lower_pf <- predictions - 1.96 * se_pf
plot(dat, xlim = c(1875, 2002), ylim = c(573, 583), ylab = "Value", las = 1,
main = "Time Series with Prediction Plot")
lines(x = 1972:2002, y = c(dat[98], predictions), lty = 2)
lines(x = 1973:2002, y = upper, col = "green")
lines(x = 1973:2002, y = lower, col = "green")
lines(x = 1973:2002, y = upper_pf, col = "blue", lty = 2)
lines(x = 1973:2002, y = lower_pf, col = "blue", lty = 2)
abline(v = 1973, col = "red")
legend("topright",
legend = c("Predictions of 30 Years", "Prediction Interval",
"Prediction Interval of predict()", "1973"),
lty = c(2, 1, 2, 1), col = c("black", "green", "blue", "red"), cex = 0.6)
?arima.sim
arima1 <- arima.sim(list(ar = c(3/5, -4/5)))
arima1 <- arima.sim(list(ar = c(3/5, -4/5)), n = 10000)
acf(arima1)
pacf(arima1)
arima2 <- arima.sim(list(ma = c(0.8, 1.1)), n = 10000)
acf(arima2)
pacf(arima2)
arima3 <- arima.sim(list(ar = 4/5, ma = 4/5), n = 10000)
acf(arima3)
pacf(arima3)
?legend
