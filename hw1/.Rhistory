# import data
dat <- read.csv("microsoft.csv", stringsAsFactors = FALSE)
dat
dat[1, ]
# data cleaning
dat <- dat[-1, ]
dat
summary(dat)
# data cleaning
dat <- numeric(dat[-1, ])
# data cleaning
dat <- asnumeric(dat[-1, ])
# data cleaning
dat <- numeric(dat[-1, ])
# data cleaning
dat <- dat[-1, ]
# import data
dat <- read.csv("microsoft.csv", stringsAsFactors = FALSE)
# data cleaning
dat <- dat[-1, ]
numeric(dat)
dat
as.numeric(dat)
?ts
?ts
my_ts <- ts(dat, start = 1, end = 9, frequency = 12)
my_ts
my_ts <- ts(dat, start = c(2004, 1), end = c(2018, 9), frequency = 12)
my_ts
?lm.ts
?lm
dat
# import data
dat <- read.csv("microsoft.csv", stringsAsFactors = FALSE)
# data cleaning
dat <- as.numeric(dat[-1, ])
my_ts <- ts(dat, start = c(2004, 1), end = c(2018, 9), frequency = 12)
my_ts
dat
?dat
?tiem
?time
time(my_ts)
# trend estimate
t <- time(my_ts)
lm_trend <- lm()
lm_trend <- lm(data ~ t)
lm_trend <- lm(dat ~ t)
lm_trend
# plot
plot(my_ts)
abline(lm_trend)
plot(my_ts)
abline(lm_trend)
plot(my_ts, main = "Time series and trend plot", ylab = "Value")
abline(lm_trend, col = "red")
?legend
plot(my_ts, main = "Time series and trend plot", ylab = "Value")
abline(lm_trend, col = "red")
legend("topleft", legend = "Linear Trend", col = "red", lty = 1)
legend("topright", legend = "Linear Trend", col = "red", lty = 1)
plot(my_ts, main = "Time series and trend plot", ylab = "Value")
abline(lm_trend, col = "red")
legend("topright", legend = "Linear Trend", col = "red", lty = 1)
# residuals
r <- lm_trend$residuals
acf(r)
par(mfrow = c(2,1))
plot(r)
acf(r)
par(mfrow = c(2,1))
plot(r)
acf(r)
plot(r, type = l)
plot(r, type = l)
plot(r, type = "l"")
plot(r, type = "l")
plot(r, type = "l")
plot(r, type = "l", ylab = "Residuals", xlab = "Time")
r
names(r)
names(r) <- t
r
plot(r, type = "l", ylab = "Residuals", xlab = "Time")
r
plot(x = t, y = r, type = "l", ylab = "Residuals", xlab = "Time")
plot(x = t, y = r, type = "l", ylab = "Residuals", xlab = "Time",
main = "Residual Plot")
filter
?filter
length(t)
sqrt(177)
rep(1/13, 13)
sum(rep(1/13, 13))
filter(my_ts, filter = rep(1/13, 13))
filter_trend <- filter(my_ts, filter = rep(1/13, 13))
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
abline(filter_trend)
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
line(filter_trend)
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(filter_trend)
y_ts, main = "Time Series and Trend Plot", ylab = "Value")
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(filter_trend, col = "red")
legend("topright", legend = "Smoothing", col = "red", lty = 1)
# residual plot and correlogram
r <- my_ts - filter_trend
r
# smoothing with parameter q = 6
filter_trend <- filter(my_ts, filter = rep(1/(2*6 + 1), (2*6 + 1)))
# plot
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
# plot
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(filter_trend, col = "blue")
# plot
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(filter_trend, col = "blue")
legend("topright", legend = "Smoothing", col = "blue", lty = 1)
# residual plot and correlogram
r <- my_ts - filter_trend
plot(x = t, y = r, type = "l", ylab = "Residuals", xlab = "Time",
main = "Smoothing Trend Residual Plot")
?acf
acf(r, main = "Correlogram", na.action = na.pass)
diff(my_ts)
ts_diff <- diff(my_ts)
# plot
plot(ts_diff)
# correlogram
# correlogram
acf(ts_diff)
# correlogram
acf(ts_diff, main = "Correlogram")
# plot
plot(ts_diff, main = "Differenced Data")
# plot
plot(ts_diff, main = "Differenced Data", ylab = "Value")
# correlogram
acf(ts_diff, main = "Correlogram")
?isoreg()
plot(my_ts)
plot(-my_ts)
isoreg(my_ts)
plot(isoreg(my_ts))
plot(isoreg(-my_ts))
isoreg_trend <- isoreg(-my_ts)
isoreg_trend
isoreg_trend$yf
plot(my_ts)
lines(isoreg_trend$yf)
plot(my_ts)
lines(isoreg_trend$yf)
plot(my_ts)
lines(-isoreg_trend$yf)
plot(my_ts)
lines(isoreg_trend$yf)
lines(-isoreg_trend$yf)
plot(my_ts)
lines(-isoreg_trend$yf)
lines(-isoreg_trend$yf, col = "green")
plot(my_ts)
lines(-isoreg_trend$yf, col = "green")
abline(-isoreg_trend$yf, col = "green")
plot(my_ts)
abline(-isoreg_trend$yf, col = "green")
plot(-isoreg_trend$yf, col = "green")
plot(my_ts)
lines(isoreg_trend)
?lines
lines(x = t, y = -isoreg_trend$yf)
plot(my_ts)
lines(x = t, y = -isoreg_trend$yf)
lines(x = -isoreg_trend$yf)
t(my_ts)
lines(x = -isoreg_trend$yf)
isoreg_trend
plot(my_ts)
# plot
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(filter_trend, col = "blue")
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(filter_trend, col = "blue")
isoreg_trend <- isoreg(-my_ts)$yf
isoreg_trend
isoreg_trend <- -isoreg(-my_ts)$yf
isoreg_trend
lines(isoreg_trend, col = "green")
plot(my_ts)
lines(isoreg_trend, col = "green")
# plot
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(x = t, y = filter_trend, col = "blue")
# trend estimate
t <- time(my_ts)
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(x = t, y = filter_trend, col = "blue")
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(x = t, y = filter_trend, col = "blue")
lines(filter_trend, col = "blue")
y_ts, main = "Time Series and Trend Plot", ylab = "Value")
plot(my_ts, main = "Time Series and Trend Plot", ylab = "Value")
lines(filter_trend, col = "blue")
filter_trend
oreg_trend <- -isoreg(-my_ts)$yf
plot(my_ts)
lines(ts(isoreg_trend), col = "green")
isoreg_trend <- isoreg(-my_ts)
plot(my_ts)
isoreg_trend
isoreg_trend$call
fv <- -isoreg_trend$yf
plot(my_ts)
plot(my_ts, ylab = "Value")
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
fv_ts <- ts(fv, start = c(2004, 1), end = c(2018, 9), frequency = 12)
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
lines(fv_ts)
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
lines(fv)
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
lines(fv_ts)
lines(fv_ts, color = "green")
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
lines(fv_ts, color = "green")
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
lines(fv_ts, color = "green")
lines(fv_ts, col = "green")
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
lines(fv_ts, col = "green")
plot(my_ts, ylab = "Value", main = "Time Series and Trend Plot")
lines(fv_ts, col = "green")
legend("topright", legend = "Isotonic", col = "green", lty = 1)
# residual plot and correlogram
r <- my_ts - fv_ts
plot(r)
plot(x = t, y = r, type = "l", ylab = "Residuals", xlab = "Time",
main = "Isotonic Trend Residual Plot")
acf(r)
acf(r, main = "Correlogram")
# plot and correlogram
par(mfrow = c(2,1))
par(mfrow=c(2,1))
3 * 61214 - 3 * 52574 + 39381 + 2051
155.5/4
155.5/43
154.3 / 43
153.4/43
